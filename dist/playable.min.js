var playable=function(t){"use strict";var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function o(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var g=function(){function t(t){this.type=null,this.type=t}return t.ADDED="added",t.REMOVED="removed",t.ADDED_TO_STAGE="addToStage",t.REMOVED_FROM_STAGE="removeFromStage",t.ENTER_FRAME="enterFrame",t.TICK="tick",t.TICKER_PAUSE="tickerPause",t.TICKER_RESUME="tickerResume",t.VIEWPORT_RESIZE="viewportResize",t.PROGRESS="progress",t.COMPLETE="complete",t.LOAD="load",t.ERROR="error",t.SOUND_COMPLETE="soundComplete",t}(),e=function(){function t(){this.$events={}}return t.prototype.on=function(t,e){var i=this.$events[t]||[];return i.push(e),this.$events[t]=i,this},t.prototype.off=function(t,e){var i=this.$events[t]||[];if(e){var n=i.indexOf(e);0<=n&&i.splice(n,1)}else i.length=0;return this},t.prototype.emit=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=this.$events[t];if(n&&n.length){for(var r=0,o=n;r<o.length;r++){o[r].apply(this,e)}return!0}return!1},t.prototype.hasEventListener=function(t){var e=this.$events[t];return e&&0<e.length},t.prototype.removeAllListeners=function(){return this.$events={},this},t}(),i=function(i){function t(t){var e=i.call(this)||this;return e.$stage=t,e.$timerIndex=0,e.$timers=[],e.$shouldResume=!1,e.$boundTick=e.$tick.bind(e),e.$enterFrameCallbackList=[t],e.$start(),e}return o(t,i),Object.defineProperty(t.prototype,"paused",{get:function(){return this.$paused},enumerable:!0,configurable:!0}),t.prototype.$start=function(){var i=this;window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return setTimeout(t,1e3/60)};for(var t=function(e){if(void 0===document[e?e+"Hidden":"hidden"])return"break";document.addEventListener(e+"visibilitychange",function(){var t=i.$paused;document[e+"hidden"]&&!t?(i.pause(),i.$shouldResume=!0):i.$shouldResume&&(i.resume(),i.$shouldResume=!1)})},e=0,n=["","ms","moz","webkit"];e<n.length;e++){if("break"===t(n[e]))break}return this.resume()},t.prototype.pause=function(){return this.$paused=!0,this.emit(g.TICKER_PAUSE),this},t.prototype.resume=function(){return this.$paused=!1,this.$lastTimestamp=Date.now(),this.emit(g.TICKER_RESUME),requestAnimationFrame(this.$boundTick),this},t.prototype.setTimeout=function(t,e){void 0===e&&(e=0);var i=++this.$timerIndex;return this.$timers[i]={handler:t,timeout:e,resetTime:e},i},t.prototype.clearTimeout=function(t){delete this.$timers[t]},t.prototype.setInterval=function(t,e){var i=++this.$timerIndex;return this.$timers[i]={handler:t,timeout:e,resetTime:e,interval:!0},i},t.prototype.clearInterval=function(t){delete this.$timers[t]},t.prototype.registerEnterFrameCallback=function(t){var e=this.$enterFrameCallbackList;return e.indexOf(t)<0&&e.push(t),this},t.prototype.unregisterEnterFrameCallback=function(t){var e=this.$enterFrameCallbackList,i=e.indexOf(t);return 0<=i&&e.splice(i,1),this},t.prototype.$tick=function(){if(!this.$paused){for(var t=Date.now()-this.$lastTimestamp,e=0,i=this.$enterFrameCallbackList;e<i.length;e++){i[e].emit(g.ENTER_FRAME,t)}this.emit(g.TICK,t),this.$lastTimestamp=Date.now(),this.$checkTimers(t),requestAnimationFrame(this.$boundTick)}},t.prototype.$checkTimers=function(t){var e=this.$timers;for(var i in e){var n=e[i];(n.resetTime=n.resetTime-t)<=0&&(n.handler(),n.interval?n.resetTime+=n.timeout:this.clearTimeout(+i))}},t}(e),c=function(){function n(t,e){this.set(t,e)}return Object.defineProperty(n.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},enumerable:!0,configurable:!0}),n.prototype.set=function(t,e){return this.x=t||0,this.y=e||0,this},n.prototype.add=function(t,e){return t instanceof n?(this.x+=t.x,this.y+=t.y):(this.x+=t,this.y+=e),this},n.prototype.subtract=function(t,e){return t instanceof n?(this.x-=t.x,this.y-=t.y):(this.x-=t,this.y-=e),this},n.prototype.divide=function(t,e){return t instanceof n?(this.x/=t.x,this.y/=t.y):(this.x/=t,this.y/=e),this},n.prototype.dotProduct=function(t,e){return t instanceof n?this.x*t.x+this.y*t.y:this.x*t+this.y*e},n.prototype.normalize=function(){var t=this.length;return this.x=this.x/t,this.y=this.y/t,this},n.prototype.negate=function(){return this.x*=-1,this.y*=-1,this},n.prototype.scale=function(t,e){return this.x*=t,this.y*=void 0===e?t:e,this},n.prototype.rotate=function(t){var e=this.x,i=this.y;return this.x=e*Math.cos(t)-i*Math.sin(t),this.y=e*Math.sin(t)+i*Math.cos(t),this},n.prototype.angle=function(){return Math.atan2(this.y,this.x)},n.prototype.distance=function(t){return Math.sqrt((this.x-t.x)*(this.x-t.x)+(this.y-t.y)*(this.y-t.y))},n.prototype.equals=function(t){return this.x===t.x&&this.y===t.y},n.prototype.transform=function(t){var e=this.x,i=this.y;return this.x=t.a*e+t.c*i+t.tx,this.y=t.b*e+t.d*i+t.ty,this},n.prototype.release=function(){return n.recycle(this),this},n.create=function(t,e){var i=this.$pool;return 0<i.length?i.pop().set(t,e):new n(t,e)},n.recycle=function(t){this.$pool.push(t)},n.$pool=[],n}(),r=function(){function l(t,e,i,n,r,o){0<arguments.length?this.set(t,e,i,n,r,o):this.identity()}return l.prototype.set=function(t,e,i,n,r,o){return this.a=t,this.b=e,this.c=i,this.d=n,this.tx=r,this.ty=o,this},l.prototype.identity=function(){return this.set(1,0,0,1,0,0)},l.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,n=this.d,r=this.tx,o=this.ty,s=t*n-i*e;return this.a=n/s,this.b=-e/s,this.c=-i/s,this.d=t/s,this.tx=(i*o-n*r)/s,this.ty=(e*r-t*o)/s,this},l.prototype.prepend=function(t,e,i,n,r,o){if(t instanceof l)return this.append(t.a,t.b,t.c,t.d,t.tx,t.ty);var s=this.a,h=this.b,a=this.c,u=this.d,c=this.tx,p=this.ty;return this.a=t*s+e*a,this.b=t*h+e*u,this.c=i*s+n*a,this.d=i*h+n*u,this.tx=r*s+o*a+c,this.ty=r*h+o*u+p,this},l.prototype.append=function(t,e,i,n,r,o){if(t instanceof l)return this.append(t.a,t.b,t.c,t.d,t.tx,t.ty);var s=this.a,h=this.b,a=this.c,u=this.d,c=this.tx,p=this.ty;return this.a=t*s+i*h,this.b=e*s+n*h,this.c=t*a+i*u,this.d=e*a+n*u,this.tx=t*c+i*p+r,this.ty=e*c+n*p+o,this},l.prototype.multiply=function(t){var e=this.a*t.x+this.c*t.y+this.tx,i=this.b*t.x+this.d*t.y+this.ty;return c.create(e,i)},l.prototype.scale=function(t,e){return this.append(t,0,0,void 0===e?t:e,0,0)},l.prototype.rotate=function(t){var e=Math.sin(t),i=Math.cos(t);return this.append(i,e,-e,i,0,0)},l.prototype.skew=function(t,e){return this.append(1,Math.tan(e),Math.tan(t),1,0,0)},l.prototype.translate=function(t,e){return t instanceof c?this.append(1,0,0,1,t.x,t.y):this.append(1,0,0,1,t,e)},l.prototype.equals=function(t){return t instanceof l&&this.a===t.a&&this.b===t.b&&this.c===t.c&&this.d===t.d&&this.tx===t.tx&&this.ty===t.ty},l.prototype.release=function(){l.recycle(this)},l.create=function(t,e,i,n,r,o){var s,h=this.$pool;return s=0<h.length?h.pop():new l,arguments.length?s.set(t,e,i,n,r,o):s.identity(),s},l.recycle=function(t){this.$pool.push(t)},l.$pool=[],l}(),$=function(){function o(t,e,i,n){this.set(t,e,i,n)}return o.prototype.set=function(t,e,i,n){return this.x=t||0,this.y=e||0,this.width=i||0,this.height=n||0,this},Object.defineProperty(o.prototype,"top",{get:function(){return this.y},set:function(t){this.height+=this.y-t,this.y=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"bottom",{get:function(){return this.y+this.height},set:function(t){this.height=t-this.y},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"left",{get:function(){return this.x},set:function(t){this.width+=this.x-t,this.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"right",{get:function(){return this.x+this.width},set:function(t){this.width=t-this.x},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"topLeft",{get:function(){return c.create(this.left,this.top)},set:function(t){this.top=t.y,this.left=t.x},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"bottomRight",{get:function(){return c.create(this.right,this.bottom)},set:function(t){this.bottom=t.y,this.right=t.x},enumerable:!0,configurable:!0}),o.prototype.contains=function(t,e){return t>=this.x&&t<=this.x+this.width&&e<=this.y&&e<=this.y+this.height},o.prototype.release=function(){o.recycle(this)},o.create=function(t,e,i,n){var r=this.$pool;return 0<r.length?r.pop().set(t,e,i,n):new o(t,e,i,n)},o.recycle=function(t){this.$pool.push(t)},o.$pool=[],o}(),p=function(i){function n(t){var e=i.call(this,t)||this;return e.$init(t),e}return o(n,i),n.prototype.$init=function(t){return this.type=t,this.targetX=0,this.targetY=0,this.stageX=0,this.stageY=0,this.identifier=0,this.target=null,this.currentTarget=null,this.propagationStopped=!1,this},n.prototype.stopPropagation=function(){this.propagationStopped=!0},n.prototype.release=function(){n.recycle(this)},n.create=function(t){var e=this.$pool;return 0<e.length?e.pop().$init(t):new n(t)},n.recycle=function(t){this.$pool.push(t)},n.TOUCH_START="touchStart",n.TOUCH_MOVE="touchMove",n.TOUCH_END="touchEnd",n.TOUCH_CANCEL="touchCancel",n.TOUCH_TAP="touchTap",n.$pool=[],n}(g),b=function(i){function f(){var t=i.call(this)||this;return t.name="",t.tag="",t.touchable=!0,t.$x=0,t.$y=0,t.$width=0,t.$height=0,t.$anchorX=0,t.$anchorY=0,t.$skewX=0,t.$skewY=0,t.$scaleX=1,t.$scaleY=1,t.$rotation=0,t.$alpha=1,t.$visible=!0,t.$backgroundColor=null,t.$backgroundImage=null,t.$backgroundPattern=null,t.$backgroundFillMode="scale",t.$dirty=!0,t.$stage=null,t.$parent=null,t.$children=[],t.$touches=[],t.$canvas=document.createElement("canvas"),t.$context=t.$canvas.getContext("2d"),t.on(g.ADDED,t.$onAdded),t.on(g.REMOVED,t.$onRemoved),t.on(g.ADDED_TO_STAGE,t.$onAddedToStage),t.on(g.REMOVED_FROM_STAGE,t.$onRemovedFromStage),t}return o(f,i),Object.defineProperty(f.prototype,"width",{get:function(){return this.$width?this.$width:this.$canvas.width/f.pixelRatio},set:function(t){this.$width!==t&&(this.$width=t,this.$resizeCanvas())},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"height",{get:function(){return this.$height?this.$height:this.$canvas.height/f.pixelRatio},set:function(t){this.$height!==t&&(this.$height=t,this.$resizeCanvas())},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"x",{get:function(){return this.$x},set:function(t){this.$x!==t&&(this.$x=t,this.$markParentDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"y",{get:function(){return this.$y},set:function(t){this.$y!==t&&(this.$y=t,this.$markParentDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"anchorX",{get:function(){return this.$anchorX},set:function(t){this.$anchorX!==t&&(this.$anchorX=t,this.$markDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"anchorY",{get:function(){return this.$anchorY},set:function(t){this.$anchorY!==t&&(this.$anchorY=t,this.$markDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"skewX",{get:function(){return this.$skewX},set:function(t){this.$skewX!==t&&(this.$skewX=t,this.$markParentDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"skewY",{get:function(){return this.$skewY},set:function(t){this.$skewY!==t&&(this.$skewY=t,this.$markParentDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"scaleX",{get:function(){return this.$scaleX},set:function(t){this.$scaleX!==t&&(this.$scaleX=t,this.$markParentDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"scaleY",{get:function(){return this.$scaleY},set:function(t){this.$scaleY!==t&&(this.$scaleY=t,this.$markParentDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"rotation",{get:function(){return this.$rotation},set:function(t){this.$rotation!==t&&(this.$rotation=t,this.$markParentDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"alpha",{get:function(){return this.$alpha},set:function(t){this.$alpha!==t&&(this.$alpha=t,this.$markParentDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"backgroundColor",{get:function(){return this.$backgroundColor},set:function(t){this.$backgroundColor!==t&&(this.$backgroundColor=t,this.$markDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"backgroundImage",{get:function(){return this.$backgroundImage},set:function(t){this.$backgroundImage!==t&&(this.$backgroundImage=t,this.$backgroundPattern=this.$getPattern(this.$backgroundImage,this.$backgroundFillMode),this.$markDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"backgroundFillMode",{get:function(){return this.$backgroundFillMode},set:function(t){this.$backgroundFillMode!==t&&(this.$backgroundFillMode=t||"scale",this.$backgroundPattern=this.$getPattern(this.$backgroundImage,this.$backgroundFillMode),this.$markDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"visible",{get:function(){return this.$visible},set:function(t){this.$visible!==t&&(this.$visible=t,this.$markParentDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"dirty",{get:function(){return this.$dirty},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"stage",{get:function(){return this.$stage},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"parent",{get:function(){return this.$parent},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"children",{get:function(){return this.$children},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"ticker",{get:function(){return this.$stage?this.$stage.ticker:null},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"canvas",{get:function(){return this.$canvas},enumerable:!0,configurable:!0}),f.prototype.addChild=function(t){return this.addChildAt(t,this.$children.length)},f.prototype.addChildAt=function(t,e){return t.$parent&&t.$parent.removeChild(t),this.$stage&&t.emit(g.ADDED_TO_STAGE,this.$stage),t.emit(g.ADDED,this),this.$children.splice(e,0,t),this.$resizeCanvas(),this},f.prototype.replaceChild=function(t,e){var i=this.getChildIndex(t);return 0<=i&&(this.$children[i]=e,t.emit(g.REMOVED,this),this.$stage&&t.emit(g.REMOVED_FROM_STAGE,this.$stage)),this},f.prototype.getChildByName=function(t){for(var e=0,i=this.$children;e<i.length;e++){var n=i[e];if(n.name===t)return n}return null},f.prototype.getChildrenByTag=function(t){for(var e=[],i=0,n=this.$children;i<n.length;i++){var r=n[i];r.tag===t&&e.push(r)}return e},f.prototype.getChildAt=function(t){return this.$children[t]||null},f.prototype.getChildIndex=function(t){return this.$children.indexOf(t)},f.prototype.hasChild=function(t){return 0<=this.getChildIndex(t)},f.prototype.swapChildren=function(t,e){var i=this.getChildIndex(t),n=this.getChildIndex(e);return 0<=i&&0<=n&&this.swapChildrenAt(i,n),this},f.prototype.swapChildrenAt=function(t,e){if(t!==e){var i=this.$children[t],n=this.$children[e];i&&n&&(this.$children[t]=n,this.$children[e]=i,this.$markDirty())}return this},f.prototype.setChildIndex=function(t,e){var i=this.$children,n=this.getChildIndex(t);if(0<=n&&n<e){for(var r=n+1;r<=e;++r)i[r-1]=i[r];i[e]=t,this.$markDirty()}else if(0<=n&&e<n){for(r=n-1;e<=r;--r)i[r+1]=i[r];i[e]=t,this.$markDirty()}return this},f.prototype.removeChild=function(t){var e=this.$children.indexOf(t);return this.removeChildAt(e)},f.prototype.removeChildAt=function(t){if(0<=t){var e=this.$children.splice(t,1)[0];e.emit(g.REMOVED,this),this.$stage&&e.emit(g.REMOVED_FROM_STAGE,this.$stage),this.$resizeCanvas()}return this},f.prototype.removeChildrenByName=function(t){for(var e=this.$children,i=0,n=e.length;i<n;++i){if(e[i].name===t){this.removeChildAt(i);break}}return this},f.prototype.removeChildrenByTag=function(t){for(var e=this.$children,i=e.length-1;0<=i;--i){e[i].tag===t&&this.removeChildAt(i)}return this},f.prototype.removeAllChildren=function(){for(var t=0,e=this.$children;t<e.length;t++){var i=e[t];i.emit(g.REMOVED,this),this.$stage&&i.emit(g.REMOVED_FROM_STAGE)}return this.$children.length=0,this.$resizeCanvas(),this},f.prototype.removeSelf=function(){return this.$parent&&this.$parent.removeChild(this),this},f.prototype.$getTransform=function(){var t=r.create();return t.translate(-this.$anchorX,-this.$anchorY),t.rotate(this.rotation*Math.PI/180).scale(this.scaleX,this.scaleY).skew(this.skewX,this.skewY),t.translate(this.x,this.y),t},f.prototype.$resizeCanvas=function(){var t=this.$width,e=this.$height,i=this.$canvas,n=this.$parent,r=this.$anchorX,o=this.$anchorY,s=f.pixelRatio;if(t&&e)i.width=t*s,i.height=e*s;else{var h=this.$getContentBounds();i.width=(t||h.right+r)*s,i.height=(e||h.bottom+o)*s,h.release()}n&&n.$resizeCanvas(),this.$dirty=!0},f.prototype.$getBounds=function(){var t=$.create(),e=this.$getTransform(),i=c.create(0,0).transform(e),n=c.create(this.width,0).transform(e),r=c.create(0,this.height).transform(e),o=c.create(this.width,this.height).transform(e),s=Math.min(i.x,n.x,r.x,o.x),h=Math.max(i.x,n.x,r.x,o.x),a=Math.min(i.y,n.y,r.y,o.y),u=Math.max(i.y,n.y,r.y,o.y);return t.top=a,t.bottom=u,t.left=s,t.right=h,e.release(),i.release(),n.release(),r.release(),o.release(),t},f.prototype.$getContentBounds=function(){for(var t=this.$children,e=$.create(),i=0,n=t;i<n.length;i++){var r=n[i].$getBounds();e.top=Math.min(e.top?e.top:1/0,r.top),e.bottom=Math.max(e.bottom?e.bottom:-1/0,r.bottom),e.left=Math.min(e.left?e.left:1/0,r.left),e.right=Math.max(e.right?e.right:-1/0,r.right),r.release()}return e},f.prototype.$emitTouchEvent=function(t){if(!this.visible||!this.touchable)return!1;var e=t.type,i=this.$touches,n=t.identifier,r=this.$getTransform(),o=c.create(t.targetX,t.targetY).transform(r.invert()).subtract(this.$anchorX,this.$anchorY),s=o.x<-this.anchorX||o.x>this.width-this.anchorX||o.y<-this.anchorY||o.y>this.height-this.anchorY;if(e===p.TOUCH_START&&s)return!1;if(e===p.TOUCH_START)i[n]=!0;else{if(!i[n])return!1;e===p.TOUCH_TAP&&(i[n]=!1)}var h=this.$children;t.targetX=o.x,t.targetY=o.y;for(var a=h.length-1;0<=a;--a){if(h[a].$emitTouchEvent(t))break}return t.propagationStopped||e===p.TOUCH_TAP&&s||(t.target=t.target||this,t.currentTarget=this,t.localX=o.x,t.localY=o.y,this.emit(t.type,t)),r.release(),o.release(),!0},f.prototype.$getPattern=function(t,e){return t&&e&&"scale"!==e&&"no-repeat"!==e?this.$context.createPattern(t.element,e):null},f.prototype.$drawBackground=function(t,e,i,n,r){var o=r||this.$context,s=o.canvas,h=s.width,a=s.height,u=f.pixelRatio;t&&(o.save(),o.fillStyle=t,o.fillRect(0,0,h,a),o.restore()),e&&("scale"===n?o.drawImage(e.element,0,0,h,a):"no-repeat"===n?o.drawImage(e.element,0,0,e.width*u,e.height*u):i&&(o.save(),o.scale(u,u),o.fillStyle=i,o.fillRect(0,0,h,a),o.restore()))},f.prototype.$drawChild=function(t){if(t.width&&t.height){var e=this.$context,i=f.pixelRatio,n=t.$getTransform().scale(i);t.$render(),e.globalAlpha=t.alpha,1===n.a&&0===n.b&&0===n.c&&1===n.d?e.drawImage(t.$canvas,n.tx,n.ty,t.width,t.height):(e.save(),e.transform(n.a,n.b,n.c,n.d,n.tx,n.ty),e.drawImage(t.$canvas,0,0,t.width,t.height),e.restore()),n.release()}},f.prototype.$render=function(){if(this.$dirty){var t=this.$context,e=this.$canvas,i=this.$children,n=this.$backgroundColor,r=this.$backgroundImage,o=this.$backgroundPattern,s=this.$backgroundFillMode,h=f.pixelRatio,a=this.$anchorX*h,u=this.$anchorY*h,c=e.width,p=e.height;t.resetTransform(),t.clearRect(0,0,c,p),this.$drawBackground(n,r,o,s),t.translate(a,u),t.save();for(var l=0,$=i;l<$.length;l++){var d=$[l];d.visible&&d.alpha&&this.$drawChild(d)}t.restore(),this.$dirty=!1}},f.prototype.on=function(t,e){return i.prototype.on.call(this,t,e),t===g.ENTER_FRAME&&this.$stage?this.$stage.ticker.registerEnterFrameCallback(this):t===g.ADDED&&this.$parent?e():t===g.ADDED_TO_STAGE&&this.$stage&&e(),this},f.prototype.off=function(t,e){return i.prototype.off.call(this,t,e),this.$stage&&t===g.ENTER_FRAME&&!this.hasEventListener(g.ENTER_FRAME)&&this.$stage.ticker.unregisterEnterFrameCallback(this),this},f.prototype.$onAdded=function(t){this.$parent=t},f.prototype.$onRemoved=function(){this.$parent=null},f.prototype.$onAddedToStage=function(t){var e=this.$children;this.hasEventListener(g.ENTER_FRAME)&&t.ticker.registerEnterFrameCallback(this),this.$stage=t;for(var i=0,n=e;i<n.length;i++){n[i].emit(g.ADDED_TO_STAGE,t)}},f.prototype.$onRemovedFromStage=function(t){var e=this.$children;this.hasEventListener(g.ENTER_FRAME)&&t.ticker.unregisterEnterFrameCallback(this),this.$stage=null;for(var i=0,n=e;i<n.length;i++){n[i].emit(g.ADDED_TO_STAGE)}},f.prototype.$markDirty=function(){this.$dirty=!0,this.$markParentDirty()},f.prototype.$markParentDirty=function(){this.$parent&&this.$parent.$markDirty()},f.pixelRatio=window.devicePixelRatio||1,f}(e),s=function(e){function t(){var t=e.call(this)||this;return t.$scrollX=0,t.$scrollY=0,t.$scrollCanvas=document.createElement("canvas"),t.$scrollContext=t.$scrollCanvas.getContext("2d"),t}return o(t,e),t.prototype.$render=function(){this.dirty&&e.prototype.$render.call(this)},t}(b),h=function(s){function t(t,e,i){var n=s.call(this)||this;return t&&(n.$width=e||t.width,n.$height=i||t.height,n.$boundOnImageLoad=n.$onImageLoad.bind(n),n.image=t),n}return o(t,s),Object.defineProperty(t.prototype,"image",{get:function(){return this.$image},set:function(t){this.$image=t,this.$width=this.$width||t.width,this.$height=this.$height||t.height,this.$resizeCanvas(),this.$width||this.$height||t.on("load",this.$boundOnImageLoad)},enumerable:!0,configurable:!0}),t.prototype.$onImageLoad=function(){var t=this.$image;this.$width=this.$width||t.width,this.$height=this.$height||t.height,this.$resizeCanvas(),t.off("load",this.$boundOnImageLoad)},t.prototype.$render=function(){if(this.$dirty){s.prototype.$render.call(this);var t=this.$image,e=this.$context,i=this.$canvas,n=b.pixelRatio,r=this.$anchorX*n,o=this.$anchorY*n;e.drawImage(t.element,-r,-o,i.width,i.height)}},t}(b),a=function(v){function a(t,e){void 0===e&&(e={});var i=v.call(this)||this;return i.$text="",i.$color="black",i.$fontSize=a.defaultFontSize,i.$fontStyle="normal",i.$fontWeight="normal",i.$textAlign="left",i.$verticalAlign="top",i.$lineHeight=1,i.$strokeSize=0,i.$strokeColor=null,i.$fontFamily="Helvetica",i.$multiline=!1,i.$breakWord=!1,i.$autoFitSize=!1,i.$minFontSize=0,i.$explicitSize=0,i.$lines=[],i.$text=t||i.$text,i.$color=e.color||i.$color,i.$fontSize=e.fontSize||i.$fontSize,i.$fontStyle=e.fontStyle||i.$fontStyle,i.$fontWeight=e.fontWeight||i.$fontWeight,i.$textAlign=e.textAlign||i.$textAlign,i.$verticalAlign=e.verticalAlign||i.$verticalAlign,i.$lineHeight=e.lineHeight||i.$lineHeight,i.$strokeSize=e.strokeSize||i.$strokeSize,i.$strokeColor=e.strokeColor||i.$strokeColor,i.$fontFamily=e.fontFamily||i.$fontFamily,i.$multiline=e.multiline||i.$multiline,i.$breakWord=e.breakWord||i.$breakWord,i.$resizeCanvas(),i}return o(a,v),Object.defineProperty(a.prototype,"text",{get:function(){return this.$text},set:function(t){this.$text=t,this.$resizeCanvas()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"color",{get:function(){return this.$color},set:function(t){this.$color=t,this.$markDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"fontSize",{get:function(){return this.$fontSize},set:function(t){this.$fontSize=t,this.$resizeCanvas()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"fontStyle",{get:function(){return this.$fontStyle},set:function(t){this.$fontStyle=t,this.$resizeCanvas()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"fontWeight",{get:function(){return this.$fontWeight},set:function(t){this.$fontWeight=t,this.$resizeCanvas()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"textAlign",{get:function(){return this.$textAlign},set:function(t){this.$textAlign=t,this.$markDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"verticalAlign",{get:function(){return this.$verticalAlign},set:function(t){this.$verticalAlign=t,this.$markDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"lineHeight",{get:function(){return this.$lineHeight},set:function(t){this.$lineHeight=t,this.$resizeCanvas()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"strokeSize",{get:function(){return this.$strokeSize},set:function(t){this.$strokeSize=t,this.$markDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"strokeColor",{get:function(){return this.$strokeColor},set:function(t){this.$strokeColor=t,this.$markDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"fontFamily",{get:function(){return this.$fontFamily},set:function(t){this.$fontFamily=t,this.$resizeCanvas()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"multiline",{get:function(){return this.$multiline},set:function(t){this.$multiline=t,this.$resizeCanvas()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"breakWord",{get:function(){return this.$breakWord},set:function(t){this.$breakWord=t,this.$resizeCanvas()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"autoFitSize",{get:function(){return this.$autoFitSize},set:function(t){this.$autoFitSize=t,this.$resizeCanvas()},enumerable:!0,configurable:!0}),a.prototype.$updateContext=function(){var t=this.$context,e=this.$fontStyle,i=this.$fontWeight,n=b.pixelRatio,r=(this.$explicitSize||this.$fontSize)*n+"px";t.font=e+" "+i+" "+r+" "+this.fontFamily,t.textAlign=this.textAlign,t.textBaseline="top",t.fillStyle=this.color,t.lineWidth=this.strokeSize*n,t.strokeStyle=this.strokeColor},a.prototype.$divideUnits=function(){var t,e=this.$text,i=this.$breakWord,n=a.wordRe,r=a.boundaryRe;if(i)t=e.split("");else{t=[];for(var o=0,s=e.split(r);o<s.length;o++){var h=s[o];n.test(h)?t.push(h):t=t.concat(h.split(""))}}return t},a.prototype.$divideLines=function(){var t=this.$text;if(this.$multiline)if(this.$width){var e="",i=this.$context,n=this.$width,r=this.$lines=[],o=this.$divideUnits();this.$updateContext();for(var s=0,h=o;s<h.length;s++){var a=h[s];if("\n"!==a)i.measureText(e+a).width<=n?e+=a:(e&&r.push(e),e=a);else r.push(e),e=""}r.push(e)}else this.$lines=t.split("\n");else this.$lines=[t]},a.prototype.$resizeCanvas=function(){var t=this.$width,e=this.$height;if(this.$divideLines(),this.$autoFitSize&&(t||e)){var i=this.$minFontSize||1;for(this.$explicitSize=this.$fontSize;this.$explicitSize>i;){var n=this.$getContentBounds();if(!(t&&n.width>t||e&&n.height>e))break;--this.$explicitSize,n.release()}}v.prototype.$resizeCanvas.call(this)},a.prototype.$getContentBounds=function(){var t=this.$context,e=v.prototype.$getContentBounds.call(this),i=this.$lines,n=this.$lineHeight,r=b.pixelRatio,o=this.$explicitSize||this.$fontSize;this.$updateContext();for(var s=0,h=i;s<h.length;s++){var a=h[s];e.width=Math.max(e.width,t.measureText(a).width/r)}return e.height=Math.max(e.height,o*n*i.length),e},a.prototype.$render=function(){if(this.$dirty){var t=0,e=0,i=this.width,n=this.height,r=this.anchorX,o=this.anchorY,s=this.$context,h=this.$lines,a=this.$color,u=this.$textAlign,c=this.$verticalAlign,p=this.$lineHeight,l=this.$strokeSize,$=this.$strokeColor,d=b.pixelRatio,f=this.$explicitSize||this.$fontSize;v.prototype.$render.call(this),this.$updateContext(),t="center"===u?i*d/2-r*d:"right"===u?i*d-r*d:-r*d,e="middle"===c?(n-f*p*h.length)*d/2-o*d:"bottom"===c?(n-f*p*h.length)*d-o*d:-o*d;for(var g=0,y=h;g<y.length;g++){var m=y[g];a&&s.fillText(m,t,e),l&&$&&s.strokeText(m,t,e),e+=f*p*d}}},a.defaultFontSize=16,a.wordRe=/\w+/,a.boundaryRe=/\b/,a}(b),u=function(i){function t(t){var e=i.call(this)||this;return e.$ticker=t,e.$boundOnLoad=e.$onLoad.bind(e),e.$boundOnError=e.$onError.bind(e),e}return o(t,i),Object.defineProperty(t.prototype,"element",{get:function(){return this.$element},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"url",{set:function(t){this.$element.src=t},enumerable:!0,configurable:!0}),t.prototype.$onLoad=function(){this.emit("load"),this.$element.removeEventListener(g.LOAD,this.$boundOnLoad)},t.prototype.$onError=function(t){this.emit("error",t),this.$element.removeEventListener(g.ERROR,this.$boundOnError)},t}(e),f=function(n){function t(t){var e=n.call(this,t)||this,i=document.createElement("img");return i.crossOrigin="*",i.addEventListener("load",e.$boundOnLoad),i.addEventListener("error",e.$boundOnError),e.$element=i,e}return o(t,n),Object.defineProperty(t.prototype,"element",{get:function(){return this.$element},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.$element.width},set:function(t){this.$element.width=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.$element.height},set:function(t){this.$element.height=t},enumerable:!0,configurable:!0}),t}(u),y=function(n){function t(t){var e=n.call(this,t)||this;e.$loops=1,e.$startTime=0,e.$paused=!1;var i=document.createElement("audio");return i.crossOrigin="*",i.addEventListener("canplaythrough",e.$boundOnLoad),i.addEventListener("error",e.$boundOnError),i.addEventListener("ended",e.$onEnded.bind(e)),e.$element=i,e.$ticker=t,e.$boundOnTouch=e.$onTouch.bind(e),t.on(g.TICKER_PAUSE,e.$onTickerPause.bind(e)),t.on(g.TICKER_RESUME,e.$onTickerResume.bind(e)),e}return o(t,n),Object.defineProperty(t.prototype,"element",{get:function(){return this.$element},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"url",{set:function(t){this.$paused=!0,this.$element.src=t,this.$element.load(),0===t.indexOf("data:")&&this.$ticker.setTimeout(this.$boundOnLoad)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"volume",{get:function(){return this.$element.volume},set:function(t){this.$element.volume=t},enumerable:!0,configurable:!0}),t.prototype.$checkOnTouch=function(){document.addEventListener("click",this.$boundOnTouch),document.addEventListener("touchend",this.$boundOnTouch)},t.prototype.$checkStatus=function(){this.$element.play().catch(),this.$paused&&this.$element.pause()},t.prototype.$onTouch=function(){this.$checkStatus(),document.removeEventListener("click",this.$boundOnTouch),document.removeEventListener("touchend",this.$boundOnTouch)},t.prototype.$onEnded=function(){1===this.$loops?(this.stop(),this.emit(g.SOUND_COMPLETE)):0===this.$loops?this.play(this.$startTime,0):this.play(this.$startTime,this.$loops-1)},t.prototype.$onTickerPause=function(){this.$paused||this.$element.pause()},t.prototype.$onTickerResume=function(){this.$paused||this.$checkStatus()},t.prototype.play=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),this.$loops=e,this.$startTime=t,this.$element.currentTime=t,this.$paused=!1,this.$checkStatus(),this},t.prototype.stop=function(){return this.$paused=!0,this.$element.pause(),this},t.prototype.$onLoad=function(){n.prototype.$onLoad.call(this),this.$element.play().then(this.$checkStatus.bind(this)).catch(this.$checkOnTouch.bind(this))},t}(u),m=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t}(y),d=function(r){function d(t,e,i){var n=r.call(this)||this;return n.$errorCount=0,n.$loadedCount=0,n.$loadingCount=0,n.$ticker=t,n.threads=i&&i.threads||2,n.timeout=i&&i.timeout||1e4,n.retryTimes=i&&i.retryTimes||3,n.$list=e.concat(),n.$total=e.length,n.$resources={},n.$checkPendingTasks(),n}return o(d,r),Object.defineProperty(d.prototype,"total",{get:function(){return this.$total},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"errorCount",{get:function(){return this.$errorCount},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"loadedCount",{get:function(){return this.$loadedCount},enumerable:!0,configurable:!0}),d.prototype.$checkPendingTasks=function(){this.$loadingCount<this.threads&&0<this.$list.length&&(++this.$loadingCount,this.$load(this.$list.shift(),1))},d.prototype.$load=function(i,n){var r,o,s=this,h=i.name,t=i.type,e=i.url,a=this.$total,u=this.$ticker,c=this.$resources,p=this.retryTimes,l=function(){var t=s.$errorCount,e=++s.$loadedCount;--s.$loadingCount,c[h]=o,u.clearTimeout(r),o.off(g.LOAD,l),o.off(g.ERROR,$),s.emit(g.PROGRESS,(e+t)/a),e+t===a?s.emit(g.COMPLETE):s.$checkPendingTasks()},$=function(){if(n<p)s.$load(i,n+1);else{--s.$loadingCount;var t=s.$loadedCount,e=++s.$errorCount;c[h]=o,s.emit(g.PROGRESS,(t+e)/a),t+e===a?s.emit(g.COMPLETE):s.$checkPendingTasks()}u.clearTimeout(r),o.off(g.LOAD,l),o.off(g.ERROR,$)};if(t===d.TYPE_IMAGE)(o=new f(u)).on(g.LOAD,l),o.on(g.ERROR,$),o.url=e;else if(t===d.TYPE_SOUND)(o=new y(u)).on(g.LOAD,l),o.on(g.ERROR,$),o.url=e;else{if(t!==d.TYPE_SOUND_EFFECT)throw new Error("Unsupported resource type: "+t);(o=new m(u)).on(g.LOAD,l),o.on(g.ERROR,$),o.url=e}r=u.setTimeout($,this.timeout)},d.prototype.has=function(t){return!!this.$resources[t]},d.prototype.get=function(t){var e=this.$resources[t];if(!e)throw new Error("Resource not exists");return e},d.TYPE_IMAGE="image",d.TYPE_SOUND="sound",d.TYPE_SOUND_EFFECT="soundEffect",d}(e),l=function(c){function l(t){var e=c.call(this)||this;return e.$viewportBackgroundFillMode="scale",e.$scaleMode=l.SHOW_ALL,e.$ticker=new i(e),e.$viewportCanvas=t||document.createElement("canvas"),e.$viewportContext=e.$viewportCanvas.getContext("2d"),e.$boundOnWindowResize=e.$onWindowResize.bind(e),e.$initEvents(),e.width=640,e.height=1136,e.viewportWidth=0,e.viewportHeight=0,t||(e.$viewportCanvas.style.top="0",e.$viewportCanvas.style.left="0",e.$viewportCanvas.style.position="fixed",document.body.appendChild(e.$viewportCanvas)),e}return o(l,c),l.prototype.$initEvents=function(){var t,e=this,i=this.$ticker;this.$addTouchEventListeners(),this.on(g.ENTER_FRAME,this.$render),i.setTimeout(function(){e.emit(g.ADDED_TO_STAGE,e)}),window.addEventListener("resize",function(){i.clearTimeout(t),t=i.setTimeout(e.$boundOnWindowResize,100)})},Object.defineProperty(l.prototype,"x",{get:function(){return 0},set:function(t){this.$x=0},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"y",{get:function(){return 0},set:function(t){this.$y=0},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"scaleMode",{get:function(){return this.$scaleMode},set:function(t){this.scaleMode!==t&&(this.$scaleMode=t,this.$resizeCanvas())},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"viewportWidth",{get:function(){return this.$viewportWidth?this.$viewportWidth:this.$viewportCanvas.width/b.pixelRatio},set:function(t){this.$viewportWidth!==t&&(t=(this.$viewportWidth=t)||window.innerWidth,this.$viewportCanvas.width=t*b.pixelRatio,this.$viewportCanvas.style.width=t+"px",this.$resizeCanvas(),this.emit(g.VIEWPORT_RESIZE))},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"viewportHeight",{get:function(){return this.$viewportHeight?this.$viewportHeight:this.$viewportCanvas.height/b.pixelRatio},set:function(t){this.$viewportHeight!==t&&(t=(this.$viewportHeight=t)||window.innerHeight,this.$viewportCanvas.height=t*b.pixelRatio,this.$viewportCanvas.style.height=t+"px",this.$resizeCanvas(),this.emit(g.VIEWPORT_RESIZE))},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"viewportBackgroundColor",{get:function(){return this.$viewportBackgroundColor},set:function(t){this.$viewportBackgroundColor!==t&&(this.$viewportBackgroundColor=t,this.$markDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"viewportBackgroundImage",{get:function(){return this.$viewportBackgroundImage},set:function(t){this.$viewportBackgroundImage!==t&&(this.$viewportBackgroundImage=t,this.$viewportBackgroundPattern=this.$getPattern(this.$viewportBackgroundImage,this.$viewportBackgroundFillMode),this.$markDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"viewportBackgroundFillMode",{get:function(){return this.$viewportBackgroundFillMode},set:function(t){this.$viewportBackgroundFillMode!==t&&(this.$viewportBackgroundFillMode=t||"scale",this.$viewportBackgroundPattern=this.$getPattern(this.$viewportBackgroundImage,this.$viewportBackgroundFillMode),this.$markDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"ticker",{get:function(){return this.$ticker},enumerable:!0,configurable:!0}),l.prototype.createResourceManager=function(t,e){return new d(this.$ticker,t,e)},l.prototype.$addTouchEventListeners=function(){var e=this,t=this.$viewportCanvas;if(void 0!==t.ontouchstart)t.addEventListener("touchstart",function(t){e.$dispatchTouches(p.TOUCH_START,t),t.preventDefault()}),t.addEventListener("touchmove",function(t){e.$dispatchTouches(p.TOUCH_MOVE,t),t.preventDefault()},{passive:!1}),t.addEventListener("touchend",function(t){e.$dispatchTouches(p.TOUCH_END,t),e.$dispatchTouches(p.TOUCH_TAP,t)}),t.addEventListener("touchcancel",function(t){e.$dispatchTouches(p.TOUCH_CANCEL,t)});else{var i=!1;t.addEventListener("mousedown",function(t){e.$dispatchTouchEvent(p.TOUCH_START,t),i=!0}),t.addEventListener("mousemove",function(t){i&&e.$dispatchTouchEvent(p.TOUCH_MOVE,t)}),t.addEventListener("mouseup",function(t){e.$dispatchTouchEvent(p.TOUCH_END,t),i=!1}),t.addEventListener("click",function(t){e.$dispatchTouchEvent(p.TOUCH_TAP,t)}),window.addEventListener("mouseout",function(t){e.$dispatchTouchEvent(p.TOUCH_CANCEL,t)})}},l.prototype.$dispatchTouches=function(t,e){for(var i=e.changedTouches,n=0,r=i.length;n<r;++n)this.$dispatchTouchEvent(t,i[n])},l.prototype.$dispatchTouchEvent=function(t,e){if(!this.$ticker.paused){var i=p.create(t),n=this.$canvas.width,r=this.$canvas.height,o=this.$renderBounds,s=b.pixelRatio,h=this.$viewportCanvas.getBoundingClientRect(),a=(e.pageX-h.left-o.x/s)*n/o.width-this.$anchorX,u=(e.pageY-h.top-o.y/s)*r/o.height-this.$anchorY;i.targetX=i.stageX=a,i.targetY=i.stageY=u,i.identifier=e instanceof Touch?e.identifier:0,this.$emitTouchEvent(i),i.release()}},l.prototype.$calculateRenderBounds=function(){var t=0,e=0,i=this.$canvas,n=i.width,r=i.height,o=this.scaleMode,s=n/r,h=this.$viewportCanvas,a=h.width,u=h.height,c=a/u,p=this.$renderBounds||$.create();o===l.NO_SCALE||(o===l.NO_BORDER?(s<c?r=(n=a)/s:n=(r=u)*s,t=(a-n)/2,e=(u-r)/2):o===l.SHOW_ALL?c<s?r=(n=a)/s:n=(r=u)*s:o===l.EXACT_FIT?(n=a,r=u):o===l.FIXED_WIDTH?r=(n=a)/s:o===l.FIXED_HEIGHT?n=(r=u)*s:o===l.FIXED_WIDE?u<a?r=(n=a)/s:n=(r=u)*s:o===l.FIXED_NARROW&&(a<u?r=(n=a)/s:n=(r=u)*s)),n<a&&(t=(a-n)/2),r<u&&(e=(u-r)/2),p.x=t,p.y=e,p.width=n,p.height=r,this.$renderBounds=p},l.prototype.$resizeCanvas=function(){c.prototype.$resizeCanvas.call(this),this.$calculateRenderBounds()},l.prototype.$render=function(){if(this.$dirty){c.prototype.$render.call(this);var t=this.$canvas,e=this.$viewportContext,i=this.$renderBounds,n=this.$viewportCanvas,r=n.width,o=n.height,s=this.$viewportBackgroundColor,h=this.$viewportBackgroundImage,a=this.$viewportBackgroundPattern,u=this.$viewportBackgroundFillMode;e.clearRect(0,0,r,o),this.$drawBackground(s,h,a,u,e),e.drawImage(t,i.x,i.y,i.width,i.height)}},l.prototype.$onWindowResize=function(){var t=this.$viewportWidth,e=this.$viewportHeight;this.viewportWidth=t,this.viewportHeight=e,this.$viewportWidth=t,this.$viewportHeight=e},l.NO_SCALE="noScale",l.NO_BORDER="noBorder",l.SHOW_ALL="showAll",l.EXACT_FIT="exactFit",l.FIXED_WIDE="fixedWide",l.FIXED_NARROW="fixedNarrow",l.FIXED_WIDTH="fixedWidth",l.FIXED_HEIGHT="fixedHeight",l}(b),v=function(){function t(){}return t.linear=function(t,e,i,n){return i*t/n+e},t.easeInQuad=function(t,e,i,n){return i*(t/=n)*t+e},t.easeOutQuad=function(t,e,i,n){return-i*(t/=n)*(t-2)+e},t.easeInOutQuad=function(t,e,i,n){return(t/=n/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e},t.easeInCubic=function(t,e,i,n){return i*(t/=n)*t*t+e},t.easeOutCubic=function(t,e,i,n){return i*((t=t/n-1)*t*t+1)+e},t.easeInOutCubic=function(t,e,i,n){return(t/=n/2)<1?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e},t.easeInQuart=function(t,e,i,n){return i*(t/=n)*t*t*t+e},t.easeOutQuart=function(t,e,i,n){return-i*((t=t/n-1)*t*t*t-1)+e},t.easeInOutQuart=function(t,e,i,n){return(t/=n/2)<1?i/2*t*t*t*t+e:-i/2*((t-=2)*t*t*t-2)+e},t.easeInQuint=function(t,e,i,n){return i*(t/=n)*t*t*t*t+e},t.easeOutQuint=function(t,e,i,n){return i*((t=t/n-1)*t*t*t*t+1)+e},t.easeInOutQuint=function(t,e,i,n){return(t/=n/2)<1?i/2*t*t*t*t*t+e:i/2*((t-=2)*t*t*t*t+2)+e},t.easeInSine=function(t,e,i,n){return-i*Math.cos(t/n*(Math.PI/2))+i+e},t.easeOutSine=function(t,e,i,n){return i*Math.sin(t/n*(Math.PI/2))+e},t.easeInOutSine=function(t,e,i,n){return-i/2*(Math.cos(Math.PI*t/n)-1)+e},t.easeInExpo=function(t,e,i,n){return 0===t?e:i*Math.pow(2,10*(t/n-1))+e},t.easeOutExpo=function(t,e,i,n){return t===n?e+i:i*(1-Math.pow(2,-10*t/n))+e},t.easeInOutExpo=function(t,e,i,n){return 0===t?e:t===n?e+i:(t/=n/2)<1?i/2*Math.pow(2,10*(t-1))+e:i/2*(2-Math.pow(2,-10*--t))+e},t.easeInCirc=function(t,e,i,n){return-i*(Math.sqrt(1-(t/=n)*t)-1)+e},t.easeOutCirc=function(t,e,i,n){return i*Math.sqrt(1-(t=t/n-1)*t)+e},t.easeInOutCirc=function(t,e,i,n){return(t/=n/2)<1?-i/2*(Math.sqrt(1-t*t)-1)+e:i/2*(Math.sqrt(1-(t-=2)*t)+1)+e},t.easeInElastic=function(t,e,i,n){var r=1.70158,o=0,s=i;return 0===t?e:1==(t/=n)?e+i:(o||(o=.3*n),r=s<Math.abs(i)?(s=i,o/4):o/(2*Math.PI)*Math.asin(i/s),-s*Math.pow(2,10*(t-=1))*Math.sin((t*n-r)*(2*Math.PI)/o)+e)},t.easeOutElastic=function(t,e,i,n){var r=1.70158,o=0,s=i;return 0===t?e:1==(t/=n)?e+i:(o||(o=.3*n),r=s<Math.abs(i)?(s=i,o/4):o/(2*Math.PI)*Math.asin(i/s),s*Math.pow(2,-10*t)*Math.sin((t*n-r)*(2*Math.PI)/o)+i+e)},t.easeInOutElastic=function(t,e,i,n){var r=1.70158,o=0,s=i;return 0===t?e:2==(t/=n/2)?e+i:(o||(o=n*(.3*1.5)),r=s<Math.abs(i)?(s=i,o/4):o/(2*Math.PI)*Math.asin(i/s),t<1?s*Math.pow(2,10*(t-=1))*Math.sin((t*n-r)*(2*Math.PI)/o)*-.5+e:s*Math.pow(2,-10*(t-=1))*Math.sin((t*n-r)*(2*Math.PI)/o)*.5+i+e)},t.easeInBack=function(t,e,i,n,r){return void 0===r&&(r=1.70158),i*(t/=n)*t*((r+1)*t-r)+e},t.easeOutBack=function(t,e,i,n,r){return void 0===r&&(r=1.70158),i*((t=t/n-1)*t*((r+1)*t+r)+1)+e},t.easeInOutBack=function(t,e,i,n,r){return void 0===r&&(r=1.70158),(t/=n/2)<1?i/2*(t*t*((1+(r*=1.525))*t-r))+e:i/2*((t-=2)*t*((1+(r*=1.525))*t+r)+2)+e},t.easeInBounce=function(t,e,i,n){return i-this.easeOutBounce(n-t,0,i,n)+e},t.easeOutBounce=function(t,e,i,n){return(t/=n)<1/2.75?i*(7.5625*t*t)+e:t<2/2.75?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e},t.easeInOutBounce=function(t,e,i,n){return t<n/2?.5*this.easeInBounce(2*t,0,i,n)+e:.5*this.easeOutBounce(2*t-n,0,i,n)+.5*i+e},t}(),E=function(n){function r(t,e){var i=n.call(this)||this;return i.loop=!1,i.$target=null,i.$paused=!0,i.$stepIndex=0,i.$stepPosition=0,i.$steps=[],i.$stepProps=[],i.$shouldSaveProps=!0,i.$target=t,i.loop=!!e&&e.loop,i.$boundOnEnterFrame=i.$onEnterFrame.bind(i),i}return o(r,n),Object.defineProperty(r.prototype,"paused",{get:function(){return this.$paused},enumerable:!0,configurable:!0}),r.prototype.set=function(t){return this.$steps.push({type:"set",props:t}),this},r.prototype.to=function(t,e,i){return this.$steps.push({type:"to",duration:e,props:t,ease:i}),this},r.prototype.wait=function(t){return this.$steps.push({type:"wait",duration:t}),this},r.prototype.call=function(t){return this.$steps.push({type:"call",callback:t}),this},r.prototype.play=function(){return this.$paused&&(this.$paused=!1,this.$target.on(g.ENTER_FRAME,this.$boundOnEnterFrame),r.$tweens.push(this)),this},r.prototype.pause=function(){if(!this.$paused){this.$paused=!0,this.$target.off(g.ENTER_FRAME,this.$boundOnEnterFrame);var t=r.$tweens.indexOf(this);0<=t&&r.$tweens.splice(t,1)}return this},r.prototype.$onEnterFrame=function(t){var e=this.loop,i=this.$steps,n=this.$steps.length,r=this.$stepIndex,o=this.$stepPosition+t,s=i[r],h=s.type,a=s.duration||0,u=s.props,c=s.ease||v.linear,p=s.callback;"set"===h?this.$setProps(u):"to"===h?this.$easeProps(r,u,o,a,c):"call"===h&&p.call(this.$target),o<a?this.$stepPosition=o:r+1<n?(this.$stepPosition=0,this.$stepIndex=r+1,this.$shouldSaveProps=!0,this.$setProps(u),this.$onEnterFrame(o-a)):e?(this.$stepIndex=0,this.$stepPosition=0,this.$shouldSaveProps=!0,this.$setProps(u),this.$onEnterFrame(o-a)):(this.$stepIndex=0,this.$stepPosition=0,this.$shouldSaveProps=!0,this.$setProps(u),this.pause())},r.prototype.$saveOriginalProps=function(t,e){var i=this.$target,n=this.$stepProps,r=n[t]=n[t]||{};for(var o in e)r[o]=i[o];this.$shouldSaveProps=!1},r.prototype.$easeProps=function(t,e,i,n,r){this.$shouldSaveProps&&this.$saveOriginalProps(t,e);var o=this.$target,s=this.$stepProps[t]||{};for(var h in n<i&&(i=n),e){var a=s[h],u=e[h]-a;o[h]=r(i,a,u,n)}},r.prototype.$setProps=function(t){var e=this.$target;for(var i in t)e[i]=t[i]},r.get=function(t,e){var i=new r(t,e);return r.$tweens.push(i),i},r.pauseTweens=function(t){for(var e=0,i=this.$tweens;e<i.length;e++){var n=i[e];n.$target===t&&n.pause()}},r.resumeTweens=function(t){for(var e=0,i=this.$tweens;e<i.length;e++){var n=i[e];n.$target===t&&n.play()}},r.removeTweens=function(t){for(var e=this.$tweens,i=e.length-1;0<=i;--i){var n=e[i];n.$target===t&&n.pause()}},r.removeAllTweens=function(){for(var t=this.$tweens,e=t.length-1;0<=e;--e){t[e].pause()}},r.$tweens=[],r}(e);return t.Ticker=i,t.Layer=b,t.ScrollView=s,t.ImageView=h,t.TextView=a,t.Stage=l,t.Event=g,t.TouchEvent=p,t.EventEmitter=e,t.Matrix=r,t.Vector=c,t.Rectangle=$,t.Media=u,t.Image=f,t.Sound=y,t.SoundEffect=m,t.Ease=v,t.Tween=E,t.ResourceManager=d,t}({});
